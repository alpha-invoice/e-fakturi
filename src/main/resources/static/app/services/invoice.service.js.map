{"version":3,"file":"invoice.service.js","sourceRoot":"","sources":["file:///C:/Users/stefanterziyski/workspace/workspaceJEE/Invoices_frontend/invoices-frontend/tmp/broccoli_type_script_compiler-input_base_path-9BF65skb.tmp/0/src/app/services/invoice.service.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAA8B,eAAe,CAAC,CAAA;AAC9C,qBAAwD,eAAe,CAAC,CAAA;AACxE,wBAA2B,mBAAmB,CAAC,CAAA;AAC/C,QAAO,6BAA6B,CAAC,CAAA;AACrC,QAAO,qBAAqB,CAAC,CAAA;AAC7B,wBAAsB,mBAAmB,CAAC,CAAA;AAC1C,qBAAmB,gBAAgB,CAAC,CAAA;AAGpC;;;;;GAKG;AAEH;IAGI,wBAAoB,IAAU;QAAV,SAAI,GAAJ,IAAI,CAAM;QAFtB,eAAU,GAAG,WAAW,CAAC;IAEC,CAAC;IAEnC;;;OAGG;IACH,mCAAU,GAAV,UAAW,UAAmB;QAC1B,IAAI,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QACtC,IAAI,OAAO,GAAG,IAAI,cAAO,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAClE,IAAI,OAAO,GAAG,IAAI,qBAAc,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACvD,MAAM,CAAC,IAAI,CAAC,IAAI;aACX,KAAK,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,EAAE,OAAO,CAAC;aACrC,SAAS,EAAE,CAAC;IACrB,CAAC;IAEH;;;;;OAKG;IACH,8CAA8C;IAC9C,oCAAW,GAAX;QACM,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC;aAClC,GAAG,CAAC,UAAC,GAAG,IAAK,OAAA,GAAG,CAAC,IAAI,EAAE,EAAV,CAAU,CAAC;aACxB,GAAG,CAAC,UAAA,OAAO,IAAI,OAAA,OAAO,CAAC,GAAG,CAAC,UAAA,CAAC;YAC3B,QAAQ,CAAC;YACT,IAAI,aAAa,GAAG,iBAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;YAChE,IAAI,gBAAgB,GAAG,iBAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;YACtE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,UAAA,CAAC,IAAG,OAAA,WAAI,CAAC,sBAAsB,CAAC,CAAC,CAAC,EAA9B,CAA8B,CAAC,CAAC;YAChD,MAAM,CAAC,IAAI,iBAAO,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,aAAa,EAAE,aAAa,EAAE,gBAAgB,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;QACtF,CAAC,CAAC,EANc,CAMd,CAAC;aACF,SAAS,EAAE,CAAC;IACnB,CAAC;IArCL;QAAC,iBAAU,EAAE;;sBAAA;IAuCb,qBAAC;AAAD,CAAC,AAtCD,IAsCC;AAtCY,sBAAc,iBAsC1B,CAAA","sourcesContent":["import { Injectable }    from '@angular/core';\r\nimport { Headers, Http, Response, RequestOptions } from '@angular/http';\r\nimport { Invoice }    from '../models/invoice';\r\nimport 'rxjs/add/operator/toPromise';\r\nimport 'app/rxjs-extensions';\r\nimport {Company} from \"../models/company\";\r\nimport {Item} from \"../models/item\";\r\nimport {Observable} from \"rxjs/Rx\";\r\n\r\n/**\r\n * Represents an Invoice service class.\r\n * It handles all HTTP requests to the business layer\r\n * in order to store/retrieve Invoice objects.\r\n * @class\r\n */\r\n@Injectable()\r\nexport class InvoiceService {\r\n    private serviceUrl = '/invoices';\r\n\r\n    constructor(private http: Http) { }\r\n\r\n    /**\r\n     * Stores a new Invoice to the database.\r\n     * @return a Promise of the request\r\n     */\r\n    addInvoice(newInvoice: Invoice): Promise<Response> {\r\n        let body = JSON.stringify(newInvoice);\r\n        let headers = new Headers({ 'Content-Type': 'application/json' });\r\n        let options = new RequestOptions({ headers: headers });\r\n        return this.http\r\n            .patch(this.serviceUrl, body, options)\r\n            .toPromise();\r\n    }\r\n\r\n  /**\r\n   * Retrieves all invoices stored in the database by\r\n   * mapping the resulting string to a js object and\r\n   * returning TypeScript instantiated classes.\r\n   * @returns a Promise which holds all the invoices\r\n   */\r\n  //TODO: should retrieve user specific invoices\r\n  getInvoices(): Promise<Invoice[]> {\r\n        return this.http.get(this.serviceUrl)\r\n          .map((res) => res.json())\r\n          .map(invoice => invoice.map(i => {\r\n            debugger;\r\n            var senderCompany = Company.parseInputObjectToCompany(i.sender);\r\n            var recipientCompany = Company.parseInputObjectToCompany(i.recipient);\r\n            i.items.map(i=> Item.parseInputObjectToItem(i));\r\n            return new Invoice(i.id, i.invoiceNumber, senderCompany, recipientCompany, i.items);\r\n          }))\r\n          .toPromise();\r\n    }\r\n\r\n}\r\n"]}